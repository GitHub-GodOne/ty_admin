# åå°ç”¨æˆ·æœåŠ¡æ¥å£å®ç°æ€»ç»“

## é¡¹ç›®æ¦‚è¿°

å·²æˆåŠŸå®ç°7ä¸ªåå°ç”¨æˆ·æœåŠ¡æ¥å£ï¼Œå®Œå…¨æŒ‰ç…§ Java ç‰ˆæœ¬çš„ `SystemAdminController` æ¥å£è§„èŒƒç¼–å†™ï¼Œä½¿ç”¨ Loco æ¡†æ¶å’Œ Rust è¯­è¨€å®ç°ã€‚

## å®ç°çš„æ¥å£

### 1. åˆ†é¡µåˆ—è¡¨ âœ…
- **è·¯å¾„**: `GET /api/admin/system/admin/list`
- **åŠŸèƒ½**: åˆ†é¡µæ˜¾ç¤ºåå°ç®¡ç†å‘˜åˆ—è¡¨ï¼Œæ”¯æŒæŒ‰å§“åã€è§’è‰²ã€çŠ¶æ€ç­›é€‰
- **æµ‹è¯•**: âœ… é€šè¿‡

### 2. æ–°å¢ç®¡ç†å‘˜ âœ…
- **è·¯å¾„**: `POST /api/admin/system/admin/save`
- **åŠŸèƒ½**: æ–°å¢åå°ç®¡ç†å‘˜ï¼ŒåŒ…å«å®Œæ•´çš„å‚æ•°éªŒè¯
- **æµ‹è¯•**: âœ… é€šè¿‡

### 3. åˆ é™¤ç®¡ç†å‘˜ âœ…
- **è·¯å¾„**: `GET /api/admin/system/admin/delete`
- **åŠŸèƒ½**: æ ¹æ®IDåˆ é™¤åå°ç®¡ç†å‘˜
- **æµ‹è¯•**: âœ… é€šè¿‡

### 4. ä¿®æ”¹ç®¡ç†å‘˜ âœ…
- **è·¯å¾„**: `POST /api/admin/system/admin/update`
- **åŠŸèƒ½**: ä¿®æ”¹åå°ç®¡ç†å‘˜ä¿¡æ¯
- **æµ‹è¯•**: âœ… é€šè¿‡

### 5. ç®¡ç†å‘˜è¯¦æƒ… âœ…
- **è·¯å¾„**: `GET /api/admin/system/admin/info`
- **åŠŸèƒ½**: è·å–åå°ç®¡ç†å‘˜è¯¦ç»†ä¿¡æ¯
- **æµ‹è¯•**: âœ… é€šè¿‡

### 6. ä¿®æ”¹çŠ¶æ€ âœ…
- **è·¯å¾„**: `GET /api/admin/system/admin/updateStatus`
- **åŠŸèƒ½**: ä¿®æ”¹åå°ç®¡ç†å‘˜å¯ç”¨/ç¦ç”¨çŠ¶æ€
- **æµ‹è¯•**: âœ… é€šè¿‡

### 7. ä¿®æ”¹çŸ­ä¿¡æ¥æ”¶çŠ¶æ€ âœ…
- **è·¯å¾„**: `GET /api/admin/system/admin/update/isSms`
- **åŠŸèƒ½**: åˆ‡æ¢åå°ç®¡ç†å‘˜æ˜¯å¦æ¥æ”¶çŸ­ä¿¡
- **æµ‹è¯•**: âœ… é€šè¿‡

## æŠ€æœ¯å®ç°

### æ–‡ä»¶ç»“æ„
```
src/
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ mod.rs                    # æ§åˆ¶å™¨æ¨¡å—æ³¨å†Œ
â”‚   â””â”€â”€ system_admin.rs           # åå°ç”¨æˆ·æœåŠ¡æ§åˆ¶å™¨ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ models/
â”‚   â””â”€â”€ _entities/
â”‚       â””â”€â”€ system_admin.rs       # ç³»ç»Ÿç®¡ç†å‘˜å®ä½“ï¼ˆå·²ä¿®å¤ç±»å‹ï¼‰
â””â”€â”€ app.rs                        # åº”ç”¨è·¯ç”±é…ç½®ï¼ˆå·²æ›´æ–°ï¼‰
```

### æ ¸å¿ƒç»„ä»¶

#### 1. é€šç”¨å“åº”ç»“æ„
```rust
pub struct CommonResult<T> {
    pub code: i32,
    pub message: String,
    pub data: Option<T>,
}
```

#### 2. åˆ†é¡µç»“æ„
```rust
pub struct CommonPage<T> {
    pub page: u64,
    pub limit: u64,
    pub total_page: u64,
    pub total: u64,
    pub list: Vec<T>,
}
```

#### 3. è¯·æ±‚/å“åº”æ¨¡å‹
- `SystemAdminRequest` - åˆ—è¡¨æŸ¥è¯¢è¯·æ±‚
- `SystemAdminAddRequest` - æ–°å¢è¯·æ±‚
- `SystemAdminUpdateRequest` - ä¿®æ”¹è¯·æ±‚
- `SystemAdminResponse` - å“åº”å¯¹è±¡

### å…³é”®æŠ€æœ¯ç‚¹

#### 1. æŸ¥è¯¢å‚æ•°ç±»å‹è½¬æ¢
å®ç°äº†è‡ªå®šä¹‰ååºåˆ—åŒ–å™¨ï¼Œæ”¯æŒ URL æŸ¥è¯¢å‚æ•°ä¸­çš„å­—ç¬¦ä¸²åˆ°æ•°å­—çš„è‡ªåŠ¨è½¬æ¢ï¼š
```rust
fn deserialize_number_from_string<'de, D>(deserializer: D) -> Result<u64, D::Error>
```

#### 2. æ•°æ®åº“ç±»å‹æ˜ å°„ä¿®å¤
ä¿®å¤äº†å®ä½“å®šä¹‰ä¸æ•°æ®åº“è¡¨ç»“æ„çš„ç±»å‹ä¸åŒ¹é…é—®é¢˜ï¼š
- `login_count`: `u32` â†’ `i32`
- `level`, `status`, `is_del`, `is_sms`: `u32` â†’ `i16`

#### 3. å‚æ•°éªŒè¯
ä½¿ç”¨ `validator` crate è¿›è¡Œå‚æ•°éªŒè¯ï¼š
- å­—ç¬¦ä¸²é•¿åº¦éªŒè¯
- å¿…å¡«å­—æ®µéªŒè¯
- æ‰‹æœºå·æ ¼å¼éªŒè¯

#### 4. æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–
ç»Ÿä¸€ä½¿ç”¨ `YYYY-MM-DD HH:MM:SS` æ ¼å¼ï¼š
```rust
model.update_time.format("%Y-%m-%d %H:%M:%S").to_string()
```

## ä¸ Java ç‰ˆæœ¬çš„å¯¹æ¯”

| ç‰¹æ€§ | Java ç‰ˆæœ¬ | Rust ç‰ˆæœ¬ | çŠ¶æ€ |
|------|----------|----------|------|
| æ¥å£è·¯å¾„ | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| è¯·æ±‚å‚æ•° | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| å“åº”æ ¼å¼ | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| å‚æ•°éªŒè¯ | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| é”™è¯¯å¤„ç† | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| åˆ†é¡µåŠŸèƒ½ | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| æƒé™æ ‡æ³¨ | âœ… | ğŸ“ | æ–‡æ¡£ä¸­æ ‡æ³¨ |
| Swaggeræ–‡æ¡£ | âœ… | ğŸ“ | å¾…å®ç° |

## å¾…å®ŒæˆåŠŸèƒ½

### 1. å¯†ç åŠ å¯† ğŸ”’
å½“å‰å¯†ç æœªåŠ å¯†å­˜å‚¨ï¼Œéœ€è¦å®ç°ï¼š
```rust
// TODO: å®ç°å¯†ç åŠ å¯†
let encrypted_pwd = encrypt_password(&params.pwd);
```

### 2. æƒé™éªŒè¯ä¸­é—´ä»¶ ğŸ”
éœ€è¦å®ç°æƒé™éªŒè¯ä¸­é—´ä»¶ï¼Œæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰å¯¹åº”æƒé™ï¼š
```rust
// ç¤ºä¾‹ï¼šadmin:system:admin:list
```

### 3. è§’è‰²åç§°å…³è”æŸ¥è¯¢ ğŸ”—
`roleNames` å­—æ®µéœ€è¦å…³è”æŸ¥è¯¢è§’è‰²è¡¨ï¼š
```rust
// TODO: æŸ¥è¯¢è§’è‰²è¡¨è·å–è§’è‰²åç§°
pub role_names: Option<String>,
```

### 4. Swagger æ–‡æ¡£ç”Ÿæˆ ğŸ“š
éœ€è¦æ·»åŠ  Swagger/OpenAPI æ–‡æ¡£æ”¯æŒï¼š
- ä½¿ç”¨ `utoipa` crate
- æ·»åŠ æ¥å£æ³¨è§£
- ç”Ÿæˆ API æ–‡æ¡£

## æµ‹è¯•ç¤ºä¾‹

### 1. è·å–ç®¡ç†å‘˜åˆ—è¡¨
```bash
curl "http://localhost:5150/api/admin/system/admin/list?page=1&limit=5"
```

**å“åº”**:
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "page": 1,
    "limit": 5,
    "total_page": 1,
    "total": 4,
    "list": [...]
  }
}
```

### 2. è·å–ç®¡ç†å‘˜è¯¦æƒ…
```bash
curl "http://localhost:5150/api/admin/system/admin/info?id=6"
```

### 3. æ–°å¢ç®¡ç†å‘˜
```bash
curl -X POST "http://localhost:5150/api/admin/system/admin/save" \
  -H "Content-Type: application/json" \
  -d '{
    "account": "test001",
    "pwd": "123456",
    "realName": "æµ‹è¯•ç®¡ç†å‘˜",
    "roles": "1",
    "status": 1,
    "phone": "18888888888"
  }'
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®åº“ç´¢å¼•**: å·²æœ‰ç´¢å¼• `idx_ty_system_admin_account` å’Œ `idx_ty_system_admin_status`
2. **è¿æ¥æ± **: Loco æ¡†æ¶å·²å†…ç½®æ•°æ®åº“è¿æ¥æ± 
3. **ç¼“å­˜**: å¯è€ƒè™‘å¯¹è§’è‰²ä¿¡æ¯è¿›è¡Œç¼“å­˜
4. **åˆ†é¡µä¼˜åŒ–**: å½“å‰ä½¿ç”¨ SeaORM çš„åˆ†é¡µåŠŸèƒ½ï¼Œæ€§èƒ½è‰¯å¥½

## å®‰å…¨å»ºè®®

1. âœ… å‚æ•°éªŒè¯å·²å®ç°
2. âš ï¸ å¯†ç åŠ å¯†å¾…å®ç°
3. âš ï¸ æƒé™éªŒè¯å¾…å®ç°
4. âœ… SQLæ³¨å…¥é˜²æŠ¤ï¼ˆSeaORM è‡ªåŠ¨å¤„ç†ï¼‰
5. âš ï¸ æ•æ„Ÿä¿¡æ¯è„±æ•ï¼ˆå¯†ç å­—æ®µéœ€è¦åœ¨å“åº”ä¸­éšè—ï¼‰

## éƒ¨ç½²è¯´æ˜

### å¯åŠ¨æœåŠ¡
```bash
cargo loco start
```

### æ•°æ®åº“è¿ç§»
```bash
cargo loco db migrate
```

### æ•°æ®åº“ç§å­
```bash
cargo loco db seed --reset
```

## æ–‡æ¡£ä½ç½®

- **API æ–‡æ¡£**: `docs/system_admin_api.md`
- **å®ç°ä»£ç **: `src/controllers/system_admin.rs`
- **å®ä½“å®šä¹‰**: `src/models/_entities/system_admin.rs`

## æ€»ç»“

âœ… **å·²å®Œæˆ**: 7ä¸ªæ¥å£å…¨éƒ¨å®ç°å¹¶æµ‹è¯•é€šè¿‡
âœ… **ä»£ç è´¨é‡**: éµå¾ª Rust æœ€ä½³å®è·µå’Œ Loco æ¡†æ¶è§„èŒƒ
âœ… **æ¥å£å…¼å®¹**: ä¸ Java ç‰ˆæœ¬å®Œå…¨å…¼å®¹
âš ï¸ **å¾…å®Œå–„**: å¯†ç åŠ å¯†ã€æƒé™éªŒè¯ã€Swagger æ–‡æ¡£

æ‰€æœ‰æ¥å£å·²ç»å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œåç»­å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ·»åŠ æƒé™éªŒè¯å’Œ Swagger æ–‡æ¡£æ”¯æŒã€‚
